<div id="filterrific_results">
  <div class="row mb-3 mt-3">
    <div class="col-md-12">
      <caption><p class="text-right"><%= page_entries_info stocks %></p></caption>
    </div>
  </div>

  <table class="table table-striped table-bordered mb-0">
    <thead>
      <tr>
        <th>Ticker</th>
        <th style="width: 20%">Company</th>
        <% if params[:filterrific].nil? || !params[:filterrific][:by_sector].present? %>
          <th class="text-right">Sector</th>
        <% end %>
        <th class="text-right d-none d-md-table-cell" style="width: 20%;">Industry</th>
        <th class="text-right d-none d-md-table-cell">Dividend Yield %</th>
        <th class="text-right d-none d-md-table-cell" data-toggle="tooltip" data-placement="top" title="Change in dividend yield % since yesterday">Change %</th>
        <th class="text-right d-none d-md-table-cell" data-toggle="tooltip" data-placement="top" title="Dividend growth ratio for 10 years - median">DGR %</th>
        <th class="text-right d-none d-md-table-cell" data-toggle="tooltip" data-placement="top" title="Most recent dividend increase information">MR Inc %</th>
        <th class="text-right d-none d-md-table-cell" data-toggle="tooltip" data-placement="top" title="Dividend payout ratio for the last year">DPR %</th>
        <th class="text-right d-none d-md-table-cell" data-toggle="tooltip" data-placement="top" title="Experimental"><%= filterrific_sorting_link(@filterrific, :im_index, label: 'IM Index') %></th>
      </tr>
    </thead>

    <tbody>
      <% cache(@stocks) do %>
        <% @stocks.each do |stock| %>
          <% if stock.last_dividend_yield > 0 and stock.dgr.present? %>
            <tr>
              <td><%= link_to stock.symbol, "https://www.morningstar.com/stocks/XNYS/" + stock.symbol + "/quote.html", target: :_blank %></td>
              <td><%= stock.company_name %></td>
              <% if params[:filterrific].nil? || !params[:filterrific][:by_sector].present? %>
                <td><%= stock.sector %></td>
              <% end %>
              <td><%= stock.industry %></td>
              <td class="font-weight-bold text-right" data-toggle="tooltip" data-placement="top" title="Dividend yield %">
                <%= stock.last_dividend_yield %>
              </td>
              <td class="font-weight-bold text-right" data-toggle="tooltip" data-placement="top" title="Change in dividend yield % since yesterday">
                <%= stock.dividend_change_percentage.abs %>
              </td>

              <% if stock.dgr.present? %>
                <td class="font-weight-bold text-right" data-toggle="tooltip" data-placement="top" title="Dividend growth ratio 10-yr median %"><%= stock.dgr_median %></td>
                <td class="font-weight-bold text-right" data-toggle="tooltip" data-placement="top" title="Most recent dividend increase %"><%= stock.dgr.mr_inc %></td>
              <% end %>

              <td class="font-weight-bold text-right" data-toggle="tooltip" data-placement="top" title="Dividend payout ratio %">
                <%= stock.dividend_payout_ratio %>
              </td>

              <% if stock.dgr.present? %>
                <td class="font-weight-bold text-right">
                  <%= stock.im_index %>
                </td>
              <% end %>
            </tr>
          <% end %>
        <% end %>
      <% end %>
    </tbody>
  </table>

  <div class="apple_pagination">
    <%= will_paginate stocks, :container => false%>
  </div>
</div>
